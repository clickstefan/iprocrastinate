<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iProcrastinate - Stop Procrastination</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#673AB7">
    <link rel="icon" type="image/png" sizes="192x192" href="icon-192.png">
</head>
<body>
    <div id="app">
        <header class="app-header">
            <h1>iProcrastinate</h1>
            <p class="subtitle yoda-quote" id="yodaQuote">Do or do not, procrastinate there is no try.</p>
        </header>

        <main class="main-content">
            <div class="stats-card">
                <h2>Tasks Completed</h2>
                <div class="counter" id="taskCounter">0</div>
            </div>

            <div class="task-section">
                <h3>Add New Task</h3>
                <div class="input-group">
                    <input type="text" id="taskInput" placeholder="What do you need to do?" maxlength="100">
                    <button id="addTaskBtn" class="btn-primary">Add Task</button>
                </div>
            </div>

            <div class="task-list-section">
                <h3>Your Tasks</h3>
                <ul id="taskList" class="task-list"></ul>
            </div>

            <div class="actions">
                <button id="completeTaskBtn" class="btn-success">Complete Selected Task</button>
                <button id="clearAllBtn" class="btn-danger">Clear All Tasks</button>
            </div>

            <div class="debug-section" id="debugSection" style="display: none;">
                <h3>üêõ Debug Tools</h3>
                <div class="debug-controls">
                    <button id="testNotificationBtn" class="btn-secondary">Test Notification</button>
                    <button id="checkPermissionsBtn" class="btn-secondary">Check Permissions</button>
                    <button id="checkSwBtn" class="btn-secondary">Check Service Worker</button>
                </div>
                <div class="debug-info">
                    <h4>Debug Status:</h4>
                    <div id="debugStatus" class="debug-output"></div>
                </div>
            </div>

            <div class="notification-settings">
                <h3>üì± Reminder Notifications</h3>
                <div class="notification-toggle">
                    <label class="toggle-switch">
                        <input type="checkbox" id="notificationToggle">
                        <span class="slider"></span>
                    </label>
                    <span class="toggle-label">Enable reminders (off by default)</span>
                </div>

                <div class="notification-config" id="notificationConfig" style="display: none;">
                    <div class="time-picker-section">
                        <h4>‚è∞ Reminder Times</h4>
                        <div id="timePickers" class="time-pickers">
                            <div class="time-picker-item">
                                <input type="time" class="time-input" value="09:00">
                                <button class="remove-time-btn" data-action="remove">√ó</button>
                            </div>
                        </div>
                        <button id="addTimeBtn" class="btn-secondary">+ Add Time</button>
                    </div>

                    <div class="weekday-selector">
                        <h4>üìÖ Days of the Week</h4>
                        <div class="weekdays">
                            <label class="weekday-item">
                                <input type="checkbox" value="1" checked> Mon
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="2" checked> Tue
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="3" checked> Wed
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="4" checked> Thu
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="5" checked> Fri
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="6"> Sat
                            </label>
                            <label class="weekday-item">
                                <input type="checkbox" value="0"> Sun
                            </label>
                        </div>
                    </div>

                    <div class="notification-status">
                        <p id="notificationStatus">Click "Enable reminders" to set up notifications</p>
                    </div>
                </div>
            </div>
        </main>

        <footer class="app-footer">
            <p>Stay focused, stay productive!</p>
        </footer>
    </div>

    <!-- Debug Console (only shows on localhost) -->
    <div id="debugConsole" class="debug-console" style="display: none;">
        <div class="debug-header">
            <span>üêõ Debug Console</span>
            <button id="clearConsole" class="debug-clear">Clear</button>
            <button id="toggleConsole" class="debug-toggle">Hide</button>
        </div>
        <div id="debugOutput" class="debug-output"></div>
    </div>

    <script src="yoda-quotes.js"></script>
    <script src="main.dart.js" defer></script>
    <script>
        // Debug Console for localhost
        (function() {
            const isLocalhost = window.location.hostname === 'localhost' ||
                               window.location.hostname === '127.0.0.1' ||
                               window.location.hostname === '';

            if (isLocalhost) {
                const debugConsole = document.getElementById('debugConsole');
                const debugOutput = document.getElementById('debugOutput');
                const clearBtn = document.getElementById('clearConsole');
                const toggleBtn = document.getElementById('toggleConsole');

                let isVisible = true;

                // Show debug console
                debugConsole.style.display = 'block';

                // Store original console methods
                const originalLog = console.log;
                const originalError = console.error;
                const originalWarn = console.warn;
                const originalInfo = console.info;

                function addDebugLog(message, type = 'log') {
                    const timestamp = new Date().toLocaleTimeString();
                    const logElement = document.createElement('div');
                    logElement.className = `debug-log ${type}`;
                    logElement.innerHTML = `<span class="debug-timestamp">${timestamp}</span>${message}`;
                    debugOutput.appendChild(logElement);
                    debugOutput.scrollTop = debugOutput.scrollHeight;
                }

                // Override console methods
                console.log = function(...args) {
                    originalLog.apply(console, args);
                    addDebugLog(args.join(' '), 'log');
                };

                console.error = function(...args) {
                    originalError.apply(console, args);
                    addDebugLog(args.join(' '), 'error');
                };

                console.warn = function(...args) {
                    originalWarn.apply(console, args);
                    addDebugLog(args.join(' '), 'warn');
                };

                console.info = function(...args) {
                    originalInfo.apply(console, args);
                    addDebugLog(args.join(' '), 'info');
                };

                // Clear button
                clearBtn.addEventListener('click', () => {
                    debugOutput.innerHTML = '';
                });

                // Toggle button
                toggleBtn.addEventListener('click', () => {
                    if (isVisible) {
                        debugOutput.style.display = 'none';
                        toggleBtn.textContent = 'Show';
                        isVisible = false;
                    } else {
                        debugOutput.style.display = 'block';
                        toggleBtn.textContent = 'Hide';
                        isVisible = true;
                    }
                });

                // Initial debug message
                console.log('üêõ Debug console initialized for localhost');
            }
        })();

        // Register service worker for PWA functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>